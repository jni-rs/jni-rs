
# Migrating to 0.22

This big changes in 0.22 are:

- Changes to the JavaVM and thread attachment APIs to improve safety and correctness.
- Changes to the JNI environment representation to separate the transparent FFI-safe type
  (for native method arguments) from the safe non-FFI type used to call JNI methods.
- The introduction of various macros:
  - `bind_java_type` to simplify defining Rust types that bind to Java classes.
    - Supports binding constructors, methods, fields, and native methods.
    - Supports customizing error handling, including mapping panics to Java exceptions.
  - `native_method` for limited bindings that only involve native methods.
  - `jni_mangle` to simplify defining JNI native methods with correct names and ABIs.
  - `jni_str` to create MUTF-8 encoded JNI string literals at compile time
  - `jni_sig` to parse JNI method and field signatures at compile time.
- A new `Reference` trait along with a set of conventions for caching class references and method/field IDs.
  - This allows for more ergonomic and efficient Java object bindings.
  - The `bind_java_type` macro generates types that implement this trait + follow these conventions.
- Some key types have been renamed:
  - `GlobalRef` is now `Global`.
  - `AutoLocal` is now `Auto` (and any local reference can be wrapped via `my_local.auto()`)
- - `JValueGen` has been removed. `JValue` and `JValueOwned` are now separate, unrelated, non-generic types. ([#429](https://github.com/jni-rs/jni-rs/pull/429))

Please see the CHANGELOG.md for more details on these changes.

